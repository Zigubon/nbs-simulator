<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>ZIGUBON Forest Simulator</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.50.0/build/stlite.css">
</head>
<body>
  <div id="loader" style="display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; font-family:sans-serif; color:#2c3e50;">
    <h2 style="margin-bottom:10px;">ğŸŒ² ìˆ²ì„ ì‹œë®¬ë ˆì´ì…˜ ì¤‘ì…ë‹ˆë‹¤...</h2>
    <p>í•„ìš”í•œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤. (ì•½ 5~10ì´ˆ ì†Œìš”)</p>
  </div>

  <div id="root"></div>
  
  <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.50.0/build/stlite.js"></script>
  <script>
    const fileList = [
      "app.py",
      "forest_data_2026.csv",
      "carbon_price_scenarios.csv",
      "co_benefits.csv"
    ];

    async function loadFiles() {
      const fileContents = {};
      try {
        const promises = fileList.map(async (fileName) => {
          const response = await fetch(`./${fileName}`);
          if (!response.ok) throw new Error(`íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ${fileName}`);
          const text = await response.text();
          fileContents[fileName] = text;
        });
        await Promise.all(promises);
        return fileContents;
      } catch (error) {
        document.getElementById("loader").innerHTML = `
          <h3 style="color:red">âš ï¸ ì˜¤ë¥˜ ë°œìƒ</h3>
          <p>${error.message}</p>
          <p>ê¹ƒí—ˆë¸Œ ì €ì¥ì†Œì— íŒŒì¼ ì´ë¦„ì´ ì •í™•í•œì§€ í™•ì¸í•´ì£¼ì„¸ìš”.</p>
        `;
        return null;
      }
    }

    loadFiles().then(files => {
      if (files) {
        document.getElementById("loader").style.display = "none";
        
        stlite.mount({
          // [í•µì‹¬ ìˆ˜ì •] plotly ë²„ì „ì„ 5.22.0ìœ¼ë¡œ ê³ ì •í•˜ì—¬ pyarrow ì¶©ëŒ ë°©ì§€
          requirements: ["streamlit", "pandas", "numpy", "plotly==5.22.0", "scipy"],
          entrypoint: "app.py",
          files: files
        }, document.getElementById("root"));
      }
    });
  </script>
</body>
</html>
