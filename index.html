<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>ZIGUBON Forest Simulator</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.50.0/build/stlite.css">
</head>
<body>
  <div id="root"></div>
  <script src="https://cdn.jsdelivr.net/npm/@stlite/mountable@0.50.0/build/stlite.js"></script>
  <script>
    // 1. 가져올 파일 목록 정의 (깃허브에 올라간 파일명과 정확히 일치해야 함)
    const filesToFetch = [
      "app.py",
      "forest_data_2026.csv",
      "carbon_price_scenarios.csv",
      "co_benefits.csv"
    ];

    // 2. 파일을 실제로 가져오는 함수
    async function loadFiles() {
      const fileContents = {};
      
      for (const file of filesToFetch) {
        const response = await fetch(file);
        if (!response.ok) {
          alert(`파일을 불러오지 못했습니다: ${file}\n(깃허브에 파일이 있는지 확인하세요)`);
          return null;
        }
        fileContents[file] = await response.text(); // 파일 내용을 텍스트로 저장
      }
      return fileContents;
    }

    // 3. 파일 로드 후 stlite 실행
    loadFiles().then(files => {
      if (files) {
        stlite.mount({
          requirements: ["streamlit", "pandas", "numpy", "plotly", "scipy"],
          entrypoint: "app.py", // 시작 파일
          files: files // 가져온 파일들을 가상 시스템에 입력
        }, document.getElementById("root"));
      }
    });
  </script>
</body>
</html>
